struct multi0keep {
    in start: u1,
    in inp: u32,
    out done: u1,
    out out: u32,
}

fn multi<dut: multi0keep>(in data_in: u32, out data_out: u32) {
    dut.start := 1'b1;
    dut.inp := data_in;
    assert_eq(dut.done, 1'b0);

    step();

    dut.start := 1'b0;
    dut.inp := X;

    while (!(dut.done == 1'b1)) {
        step();
    }

    assert_eq(dut.out, data_out);

    fork();
}