// ARGS: --wave alus/alu_d2.fst --instances alu_d2:ALU 
struct ALU {
  in a: u32,
  in b: u32,
  in op: u2,
  out s: u32,
}

fn add<DUT: ALU>(in a: u32, in b: u32, out s: u32) {
  DUT.a := a;
  DUT.b := b;
  DUT.op := 2'b00;
  
  step();
  fork();
  
  DUT.a := X;
  DUT.b := X;

  step();
  
  DUT.a := X;
  DUT.b := X;

  assert_eq(s, DUT.s);
  step();
}

fn sub<DUT: ALU>(in a: u32, in b: u32, out s: u32) {
  DUT.a := a;
  DUT.b := b;
  DUT.op := 2'b01;
  
  step();
  fork();
  
  DUT.a := X;
  DUT.b := X;

  step();

  DUT.a := X;
  DUT.b := X;

  assert_eq(s, DUT.s);
  step();
}

fn and<DUT: ALU>(in a: u32, in b: u32, out s: u32) {
  DUT.a := a;
  DUT.b := b;
  DUT.op := 2'b10;
  
  step();
  fork();
  
  DUT.a := X;
  DUT.b := X;

  step();

  DUT.a := X;
  DUT.b := X;
  
  assert_eq(s, DUT.s);
  step();
}

fn or<DUT: ALU>(in a: u32, in b: u32, out s: u32) {
  DUT.a := a;
  DUT.b := b;
  DUT.op := 2'b11;

  step();
  fork();
  
  DUT.a := X;
  DUT.b := X;

  step();

  DUT.a := X;
  DUT.b := X;
  
  assert_eq(s, DUT.s);
  step();
}