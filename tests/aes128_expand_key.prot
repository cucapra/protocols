// src: https://github.com/ekiwi/paso/blob/ad2bf83f420ca704ff0e76e7a583791a0e80a545/benchmarks/src/benchmarks/aes/TinyAESSpec.scala#L179

struct ExpandKey128 {
  in in: u128,
  out out_1: u128,
  out out_2: u128,
}

fn aes128<dut : ExpandKey128>(in input: u128, out output: u128) {
  dut.in := input;
  step();
  fork();
  dut.in := X;
  assert_eq(dut.out_1, output);
  step();
  assert_eq(dut.out_2, output);
}